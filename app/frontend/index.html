<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-M">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Ministerio de Magia</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

    <header>
        <h1>üßô‚Äç‚ôÇÔ∏è Dashboard del Ministerio de Magia</h1>
    </header>

    <main>
        <section class="card">
            <section class="card" id="user-profile-card">
                <h2>Perfil de Usuario</h2>
                <p><strong>Usuario:</strong> <span id="user-name">...</span></p>
                <p><strong>Rol:</strong> <span id="user-role">...</span></p>
                <p><strong>Permisos Asignados:</strong></p>
                <ul id="user-permissions">
                    <li>...</li>
                </ul>
                <button id="logout-button" class="logout-button">Cerrar Sesi√≥n</button>
            </section>

            <h2>Rendimiento del Sistema (Tiempo Real)</h2>
            <div class="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>
            <div class="metrics-summary">
                <p>Latencia Media: <strong id="metric-latency">...</strong> ms</p>
                <p>Eventos/seg: <strong id="metric-events">...</strong></p>
            </div>
        </section>

        <section class="card">
            <h2>Arquitectura Modular del Sistema</h2>

            <div class="mermaid">
                graph TD
                    A[Frontend JS] -- HTTP (JSON) --> B[API - FastAPI]

                    subgraph B [ ]
                        B1(Endpoints)
                        B2(Middleware/AOP)
                        B3(DI Container)
                    end

                    B1 --> C{L√≥gica de Negocio}
                    B2 -- Aplica --> B1

                    B2 -- Usa --> D[Seguridad (AuthService)]
                    B2 -- Usa --> E[Auditor√≠a (AuditLogger)]

                    C --> F[Hechizos (Clases)]
                    C -- Usa --> G[Contenedor IoC (SpellRegistry)]
                    G --> F

                    E --> H[Logs (Archivos/DB)]
                    D --> I[Roles/Permisos]
            </div>
        </section>
        <section class="card">
                <h2>Lanzar Hechizo</h2>
                <p>Seleccione un hechizo para ejecutar (requiere permiso 'spell:cast').</p>

                <div class="form-group">
                    <label for="spell-select">Hechizos Registrados:</label>
                    <select id="spell-select">
                        <option value="Lumos">Lumos (Permitido)</option>
                        <option value="Expecto Patronum">Expecto Patronum (Permitido)</option>
                        <option value="Avada Kedavra">Avada Kedavra (Imperdonable)</option>
                        <option value="Wingardium Leviosa">Wingardium Leviosa (No registrado)</option>
                    </select>
                </div>

                <p id="spell-message" class="spell-message-text"></p>

                <button id="cast-spell-button">¬°Lanzar!</button>
            </section>
        <section class="card">
            <h2>Auditor√≠a de Eventos M√°gicos</h2>
            <table id="auditTable">
                <thead>
                    <tr>
                        <th>Tipo de Hechizo</th>
                        <th>Intentos</th>
                        <th>√âxitos</th>
                        <th>Fallos</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <script src="/static/app.js"></script>
</body>
</html>